<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Manage Tags - Music Resource Management</title>

    <!-- Favicon -->
    <link rel="shortcut icon" href="assets/media/image/favicon.png"/>

    <!-- Plugin styles -->
    <link rel="stylesheet" href="vendors/bundle.css" type="text/css">
    <!-- Font Awesome (for player controls and icons) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <!-- App styles -->
    <link rel="stylesheet" href="assets/css/app.css" type="text/css">
    
     <!-- Player and Tag Styles -->
     <style>
        /* Tag Item Styles */
        .tag-list-item { display: flex; justify-content: space-between; align-items: center; padding: 0.75rem 1rem; border-bottom: 1px solid #eee; cursor: pointer; transition: background-color 0.2s ease; }
        .tag-list-item:hover { background-color: #f8f9fa; }
        .tag-list-item:last-child { border-bottom: none; }
        .tag-name { flex-grow: 1; margin-right: 1rem; font-weight: 500; }
        .tag-actions button { margin-left: 0.5rem; }
        
        /* Song Card Styles (similar to category-songs) */
        .song-card { transition: all 0.3s ease; border-radius: 0.75rem; overflow: hidden; height: 100%; }
        .song-card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .song-image { height: 160px; object-fit: cover; border-top-left-radius: 0.75rem; border-top-right-radius: 0.75rem; }
        .song-controls { position: absolute; top: 10px; right: 10px; display: flex; gap: 5px; z-index: 10; }
        
        /* Audio Player Styles */
        .audio-player { position: fixed; bottom: 0; left: 0; right: 0; padding: 1rem; background: #fff; box-shadow: 0 -5px 15px rgba(0,0,0,0.05); z-index: 1000; }
        .player-content { display: flex; align-items: center; justify-content: space-between; max-width: 1200px; margin: 0 auto; padding: 0 1rem; }
        .song-info { display: flex; align-items: center; width: 30%; }
        .cover { width: 50px; height: 50px; margin-right: 1rem; overflow: hidden; border-radius: 4px; }
        .cover img { width: 100%; height: 100%; object-fit: cover; }
        .details h5 { margin: 0; font-size: 1rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 200px; }
        .details p { margin: 0; font-size: 0.8rem; color: #6c757d; }
        .controls { width: 40%; }
        .player-controls { display: flex; justify-content: center; gap: 1rem; margin-bottom: 0.5rem; }
        .control-button { background: none; border: none; color: #495057; cursor: pointer; padding: 0.25rem; border-radius: 50%; display: flex; align-items: center; justify-content: center; transition: all 0.2s; }
        .control-button:hover { background-color: #f8f9fa; color: #007bff; }
        .progress-container { display: flex; align-items: center; gap: 0.5rem; }
        .progress { flex-grow: 1; height: 4px; background-color: #e9ecef; }
        .progress-bar { background-color: #007bff; }
        #currentTime, #duration { font-size: 0.7rem; color: #6c757d; width: 35px; text-align: center; }
        .volume { display: flex; align-items: center; width: 20%; justify-content: flex-end; gap: 0.5rem; }
        .volume-slider { width: 80px; }
        input[type="range"] { -webkit-appearance: none; height: 4px; background: #e9ecef; border-radius: 2px; }
        input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; width: 12px; height: 12px; background: #007bff; border-radius: 50%; cursor: pointer; }
    </style>
</head>
<body>
    <!-- Preloader -->
    <div class="preloader"><div class="preloader-icon"></div></div>
    
    <!-- Main Structure -->
    <div id="main">
        <!-- Navigation (ensure it's consistent) -->
        <div class="navigation">
            <div class="navigation-menu-tab">
                <div class="flex-grow-1">
                    <ul>
                        <li><a href="#" data-toggle="tooltip" data-placement="right" title="Dashboard" data-nav-target="#dashboards"><i data-feather="home"></i></a></li>
                        <li><a href="#" data-toggle="tooltip" data-placement="right" title="My Music" data-nav-target="#my-music"><i data-feather="music"></i></a></li>
                        <li><a href="#" data-toggle="tooltip" data-placement="right" title="Categories" data-nav-target="#categories"><i data-feather="folder"></i></a></li>
                        <li><a href="#" data-toggle="tooltip" data-placement="right" title="Artists" data-nav-target="#artists"><i data-feather="users"></i></a></li>
                        <li><a href="#" data-toggle="tooltip" data-placement="right" title="Upload Music" data-nav-target="#upload"><i data-feather="upload"></i></a></li>
                        <li><a class="active" href="#" data-toggle="tooltip" data-placement="right" title="Tags" data-nav-target="#tags"><i data-feather="tag"></i></a></li>
                        <li><a href="#" data-toggle="tooltip" data-placement="right" title="Settings" data-nav-target="#settings"><i data-feather="settings"></i></a></li>
                    </ul>
                </div>
                <div><ul><li><a href="../login.html" data-toggle="tooltip" data-placement="right" title="Logout"><i data-feather="log-out"></i></a></li></ul></div>
            </div>
            <div class="navigation-menu-body">
                <div class="navigation-menu-group">
                    <div id="dashboards">
                        <ul>
                            <li class="navigation-divider">Dashboard</li>
                            <li><a href="index.html">Overview</a></li>
                            <li><a href="top-songs.html">Top Songs</a></li>
                            <li><a href="artists.html">All Artists</a></li>
                        </ul>
                    </div>
                    <div id="my-music">
                        <ul>
                            <li class="navigation-divider">My Music</li>
                            <li><a href="my-music.html">All Songs</a></li>
                            <li><a href="top-songs.html">Top Songs</a></li>
                        </ul>
                    </div>
                    <div id="categories">
                        <ul>
                            <li class="navigation-divider">Categories</li>
                            <li><a href="categories.html">Manage Categories</a></li>
                        </ul>
                    </div>
                    <div id="artists">
                        <ul>
                            <li class="navigation-divider">Artists</li>
                            <li><a href="artists.html">All Artists</a></li>
                        </ul>
                    </div>
                    <div id="upload">
                        <ul>
                            <li class="navigation-divider">Upload</li>
                            <li><a href="upload-music.html">Upload Music</a></li>
                        </ul>
                    </div>
                    <div id="tags" class="open">
                        <ul>
                            <li class="navigation-divider">Tags</li>
                            <li><a class="active" href="tag-management.html">Manage Tags</a></li>
                            <li><a href="tag-songs.html">View Songs by Tag</a></li>
                        </ul>
                    </div>
                    <div id="settings">
                        <ul>
                            <li class="navigation-divider">Settings</li>
                            <li><a href="settings.html">Profile</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <!-- end::navigation -->

        <!-- Main Content -->
        <div class="main-content">
            <!-- Breadcrumb -->
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="index.html">Home</a></li>
                    <li class="breadcrumb-item active" aria-current="page">Manage Tags</li>
                </ol>
            </nav>
            
            <!-- Alerts Container -->
            <div id="alerts" class="mb-4"></div>

            <!-- Tag Management Area (Visible by default) -->
            <div id="tagManagementArea">
                <!-- Add New Tag Form -->
                <div class="card mb-4">
                    <div class="card-body">
                        <h5 class="card-title">Create New Tag</h5>
                        <form id="addTagForm" class="d-flex">
                            <input type="text" class="form-control mr-2 flex-grow-1" id="newTagName" placeholder="Enter new tag name" required>
                            <button type="submit" class="btn btn-primary ml-2">Add Tag</button>
                        </form>
                        <div id="addTagMessage" class="mt-2"></div>
                    </div>
                </div>
                
                <!-- Existing Tags List -->
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Your Tags</h5>
                        <div id="tagListContainer" class="list-group list-group-flush">
                            <div class="text-center p-3"><span class="text-muted">Loading tags...</span></div>
                            <!-- Tags will be loaded here by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Tag Management Area -->

            <!-- Tag Songs Area (Hidden by default) -->
            <!-- REMOVED Tag Songs Area and its contents -->
            <!-- End Tag Songs Area -->

        </div>
        <!-- end::main-content -->
        
    </div>
    <!-- end::main -->

    <!-- Edit Tags Modal -->
    <div class="modal fade" id="editTagsModal" tabindex="-1" aria-labelledby="editTagsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editTagsModalLabel">Edit Tags for <span id="modalSongTitleTag">Song</span></h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <p>Select the tags this song should have:</p>
                    <form id="editTagsForm">
                        <input type="hidden" id="modalSongIdTag">
                        <!-- Container for tag pills/badges -->
                        <div id="modalTagList" class="d-flex flex-wrap gap-2 mb-3"> 
                            <!-- Tag pills will be loaded here by JS -->
                            <div class="text-center w-100">
                                <div class="spinner-border spinner-border-sm" role="status">
                                    <span class="visually-hidden">Loading tags...</span>
                                </div>
                            </div>
                        </div>
                    </form>
                     <!-- Alert for feedback -->
                    <div id="modalAlertsTags" class="mt-3"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="saveTagsButton">Save Changes</button>
                </div>
            </div>
        </div>
    </div>
    <!-- End Edit Tags Modal -->
    
    <!-- Edit Tag Name Modal (Optional) -->
    <div class="modal fade" id="editTagNameModal" tabindex="-1" aria-labelledby="editTagNameModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editTagNameModalLabel">Edit Tag Name</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                </div>
                <div class="modal-body">
                    <form id="editTagNameForm">
                        <input type="hidden" id="editTagId">
                        <div class="form-group">
                            <label for="editTagNameInput">New Tag Name</label>
                            <input type="text" class="form-control" id="editTagNameInput" required>
                        </div>
                    </form>
                     <div id="editTagNameMessage" class="mt-2"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="saveTagNameButton">Save Name</button>
                </div>
            </div>
        </div>
    </div>
    <!-- End Edit Tag Name Modal -->


    <!-- Standard Audio Player -->
    <div class="audio-player">
        <div class="player-content">
            <div class="song-info">
                <div class="cover"><img id="currentSongCover" src="assets/media/image/default-cover.jpg" alt="Cover"></div>
                <div class="details"><h5 id="currentSongTitle">No song playing</h5><p id="currentSongArtist">-</p></div>
            </div>
            <div class="controls">
                <div class="player-controls">
                    <button id="prevButton" class="control-button"><i class="fas fa-step-backward"></i></button>
                    <button id="playPauseButton" class="control-button"><i class="fas fa-play"></i></button>
                    <button id="nextButton" class="control-button"><i class="fas fa-step-forward"></i></button>
                </div>
                <div class="progress-container">
                    <span id="currentTime">0:00</span>
                    <div class="progress"><div class="progress-bar" role="progressbar" style="width: 0%"></div></div>
                    <span id="duration">0:00</span>
                </div>
            </div>
            <div class="volume">
                <button id="muteButton" class="control-button"><i class="fas fa-volume-up"></i></button>
                <div class="volume-slider"><input type="range" class="form-range" id="volumeSlider" min="0" max="100" value="100"></div>
            </div>
        </div>
        <audio id="audioPlayer"></audio>
    </div>
    <!-- End Standard Audio Player -->

    <!-- Plugin scripts -->
    <script src="vendors/bundle.js"></script>
    <!-- Axios for API requests -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <!-- SweetAlert2 CDN -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
     <!-- Feather Icons CDN -->
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <!-- Common API Module -->
    <script type="module" src="../Common/js/api.js"></script> 
    <!-- App scripts (needed for layout interactions) -->
    <script src="assets/js/app.js"></script> 
    <!-- Tag Management functionality -->
    <script type="module" src="assets/js/tag-management.js"></script> 
    <!-- Audio Player functionality -->
    <script type="module" src="assets/js/audio-player.js"></script> 
    <!-- Auth Check -->
    <script type="module" src="assets/js/auth-check.js"></script> 

     <script>
        // Initialize Feather Icons
        if (typeof feather !== 'undefined') {
            feather.replace();
        }
        // Basic setup for Bootstrap tooltips (if needed)
        $(function () {
          $('[data-toggle="tooltip"]').tooltip()
        })
    </script>

</body>
</html> 